<!DOCTYPE html>
<html><head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Genetic drift simulator</title>
  
  <script type="text/javascript" src="highcharts_files/jquery-1.js"></script>
  
  <link rel="stylesheet" type="text/css" href="highcharts_files/result-light.css">
  
  <style type="text/css">
  </style>

</head>

<body>
    <script src="highcharts_files/highcharts.js"></script>
    <script src="highcharts_files/exporting.js"></script>
    <div id="body">
        <p>To simulate genetic drift, set the population size and starting
        allele frequency below and click "Evolve!"</p>
        <div id="input_table" style="width: 500px;">
            <form name="form1">
                <label for="afreq">Starting allele frequency</label>
                <input type="range" name="allele_freq" id="afreq" min="0.0" max="1.0" step="0.01" value="0.50" oninput="output_allele_freq(value)">
                <output for="afreq" id="show_freq">0.50</output><br>
                <script>
                function output_allele_freq(freq) {
                    document.querySelector('#show_freq').value = freq;
                }
                </script>
                <label for="psize">Population size (1-100000)</label>
                <input type="number" name="pop_size" id="psize" min="1" max="100000" step="1" value="100"><br>
                <input type="button" value="Evolve!" onclick="validate_form1();"/>
            </form>
        </div>

        <div data-highcharts-chart="0" id="container" style="min-width: 310px;
            height: 400px; margin: 0 auto"><div style="position: relative;
        overflow: hidden; width: 1264px; height: 400px; text-align: left;
line-height: normal; z-index: 0; left: 0px; top: 0px;" id="highcharts-0"
class="highcharts-container"><!--<svg height="400" width="1264"
xmlns="http://www.w3.org/2000/svg" style="font-family:&quot;Lucida
Grande&quot;, &quot;Lucida Sans Unicode&quot;, Arial, Helvetica,
sans-serif;font-size:12px;" version="1.1"><desc>Created with Highcharts
4.0.4</desc><defs><clipPath id="highcharts-1"><rect height="318" width="1180"
y="0" x="0"></rect></clipPath></defs><rect class=" highcharts-background"
fill="#FFFFFF" strokeWidth="0" height="400" width="1264" y="0"
x="0"></rect><path stroke-width="1" stroke="#808080" d="M 74 311.5 L 1254
311.5" fill="none"></path><g zIndex="1" class="highcharts-grid"></g><g
zIndex="1" class="highcharts-grid"><path opacity="1" zIndex="1"
stroke-width="1" stroke="#C0C0C0" d="M 74 99.5 L 1254 99.5"
fill="none"></path><path opacity="1" zIndex="1" stroke-width="1"
stroke="#C0C0C0" d="M 74 311.5 L 1254 311.5" fill="none"></path><path
opacity="1" zIndex="1" stroke-width="1" stroke="#C0C0C0" d="M 74 45.5 L 1254
45.5" fill="none"></path><path opacity="1" zIndex="1" stroke-width="1"
stroke="#C0C0C0" d="M 74 152.5 L 1254 152.5" fill="none"></path><path
opacity="1" zIndex="1" stroke-width="1" stroke="#C0C0C0" d="M 74 205.5 L 1254
205.5" fill="none"></path><path opacity="1" zIndex="1" stroke-width="1"
stroke="#C0C0C0" d="M 74 258.5 L 1254 258.5" fill="none"></path><path
opacity="1" zIndex="1" stroke-width="1" stroke="#C0C0C0" d="M 74 364.5 L 1254
364.5" fill="none"></path></g><g zIndex="2" class="highcharts-axis"><path
opacity="1" stroke-width="1" stroke="#C0D0E0" d="M 157.5 364 L 157.5 374"
fill="none"></path><path opacity="1" stroke-width="1" stroke="#C0D0E0" d="M
279.5 364 L 279.5 374" fill="none"></path><path opacity="1" stroke-width="1"
stroke="#C0D0E0" d="M 400.5 364 L 400.5 374" fill="none"></path><path
opacity="1" stroke-width="1" stroke="#C0D0E0" d="M 521.5 364 L 521.5 374"
fill="none"></path><path opacity="1" stroke-width="1" stroke="#C0D0E0" d="M
643.5 364 L 643.5 374" fill="none"></path><path opacity="1" stroke-width="1"
stroke="#C0D0E0" d="M 764.5 364 L 764.5 374" fill="none"></path><path
opacity="1" stroke-width="1" stroke="#C0D0E0" d="M 886.5 364 L 886.5 374"
fill="none"></path><path opacity="1" stroke-width="1" stroke="#C0D0E0" d="M
1007.5 364 L 1007.5 374" fill="none"></path><path opacity="1" stroke-width="1"
stroke="#C0D0E0" d="M 1129.5 364 L 1129.5 374" fill="none"></path><path
opacity="1" stroke-width="1" stroke="#C0D0E0" d="M 1250.5 364 L 1250.5 374"
fill="none"></path><path visibility="visible" zIndex="7" stroke-width="1"
stroke="#C0D0E0" d="M 74 364.5 L 1254 364.5" fill="none"></path></g><g
zIndex="2" class="highcharts-axis"><text y="205" visibility="visible"
style="color:#707070;fill:#707070;" class=" highcharts-yaxis-title"
transform="translate(0,0) rotate(270 24 205)" text-anchor="middle" zIndex="7"
x="24">Value</text></g><g zIndex="3" class="highcharts-series-group"><g
clip-path="url(#highcharts-1)" transform="translate(74,46) scale(1 1)"
zIndex="0.1" visibility="visible" class="highcharts-series"><path
stroke-linecap="round" stroke-linejoin="round" zIndex="1" stroke-width="2"
stroke="#7cb5ec" d="M 11.56862570645867 207.9803277016661 C 11.56862570645867
207.9803277016661 48.010986663682885 75.08982807531967 72.30589396849903
75.08982807531967 C 96.60080127331517 75.08982807531967 108.74825492572324
220.19737434460188 133.0431622305394 220.19737434460188 C 157.33806953535554
220.19737434460188 169.4855231877636 187.6882813698486 193.78043049257974
187.6882813698486 C 218.0753377973959 187.6882813698486 230.22279144980394
262.74018672343624 254.5176987546201 262.74018672343624 C 278.81260605943623
262.74018672343624 290.96005971184434 143.47249061542342 315.2549670166605
143.47249061542342 C 339.54987432147664 143.47249061542342 351.6973279738847
152.40056446172264 375.99223527870083 152.40056446172264 C 401.6962472071963
152.40056446172264 414.54825317144406 98.46863956453404 440.2522650999395
98.46863956453404 C 464.3285182390124 98.46863956453404 476.3666448085487
247.29975990431362 500.44289794762153 247.29975990431362 C 524.689215437828
247.29975990431362 536.8123741829313 247.29975990431362 561.0586916731378
221.0010483111092 C 585.3778938852587 194.70233671790479 597.5374949913191
98.82935581688278 621.8566972034401 96.00460200050068 C 646.1516045082564
93.17984818411858 658.2990581606643 93.17984818411858 682.5939654654806
93.17984818411858 C 706.8888727702968 93.17984818411858 719.0363264227047
119.76703858278452 743.331233727521 122.02890607581696 C 767.626141032337
124.2907735688494 779.7735946847451 124.2907735688494 804.0685019895612
124.2907735688494 C 828.3391143870725 124.2907735688494 840.4744205858282
82.58885503011123 864.7450329833396 82.58885503011123 C 889.0642351954605
82.58885503011123 901.223836301521 175.15487650734747 925.5430385136419
175.15487650734747 C 949.8136509111533 175.15487650734747 961.948957109909
59.252458672587295 986.2195695074203 59.252458672587295 C 1010.5144768122366
59.252458672587295 1022.6619304646445 113.01521607174142 1046.9568377694607
138.32840344704098 C 1071.2760399815816 163.6669040097157 1083.4356410876421
164.05912922668955 1107.754843299763 185.881678517523 C 1132.0254556972745
207.66062631127207 1168.4313742935415 247.3321461584973 1168.4313742935415
247.3321461584973" fill="none"></path><path style="" class="
highcharts-tracker" zIndex="2" stroke-width="22"
stroke="rgba(192,192,192,0.0001)" visibility="visible" stroke-linejoin="round"
d="M 1.5686257064586702 207.9803277016661 L 11.56862570645867 207.9803277016661
C 11.56862570645867 207.9803277016661 48.010986663682885 75.08982807531967
72.30589396849903 75.08982807531967 C 96.60080127331517 75.08982807531967
108.74825492572324 220.19737434460188 133.0431622305394 220.19737434460188 C
157.33806953535554 220.19737434460188 169.4855231877636 187.6882813698486
193.78043049257974 187.6882813698486 C 218.0753377973959 187.6882813698486
230.22279144980394 262.74018672343624 254.5176987546201 262.74018672343624 C
278.81260605943623 262.74018672343624 290.96005971184434 143.47249061542342
315.2549670166605 143.47249061542342 C 339.54987432147664 143.47249061542342
351.6973279738847 152.40056446172264 375.99223527870083 152.40056446172264 C
401.6962472071963 152.40056446172264 414.54825317144406 98.46863956453404
440.2522650999395 98.46863956453404 C 464.3285182390124 98.46863956453404
476.3666448085487 247.29975990431362 500.44289794762153 247.29975990431362 C
524.689215437828 247.29975990431362 536.8123741829313 247.29975990431362
561.0586916731378 221.0010483111092 C 585.3778938852587 194.70233671790479
597.5374949913191 98.82935581688278 621.8566972034401 96.00460200050068 C
646.1516045082564 93.17984818411858 658.2990581606643 93.17984818411858
682.5939654654806 93.17984818411858 C 706.8888727702968 93.17984818411858
719.0363264227047 119.76703858278452 743.331233727521 122.02890607581696 C
767.626141032337 124.2907735688494 779.7735946847451 124.2907735688494
804.0685019895612 124.2907735688494 C 828.3391143870725 124.2907735688494
840.4744205858282 82.58885503011123 864.7450329833396 82.58885503011123 C
889.0642351954605 82.58885503011123 901.223836301521 175.15487650734747
925.5430385136419 175.15487650734747 C 949.8136509111533 175.15487650734747
961.948957109909 59.252458672587295 986.2195695074203 59.252458672587295 C
1010.5144768122366 59.252458672587295 1022.6619304646445 113.01521607174142
1046.9568377694607 138.32840344704098 C 1071.2760399815816 163.6669040097157
1083.4356410876421 164.05912922668955 1107.754843299763 185.881678517523 C
1132.0254556972745 207.66062631127207 1168.4313742935415 247.3321461584973
1168.4313742935415 247.3321461584973 L 1178.4313742935415 247.3321461584973"
fill="none"></path></g><g style="" clip-path="none" transform="translate(74,46)
scale(1 1)" zIndex="0.1" visibility="visible" class="highcharts-markers
highcharts-tracker"><path d="M 375 148.40056446172264 C 380.328
148.40056446172264 380.328 156.40056446172264 375 156.40056446172264 C 369.672
156.40056446172264 369.672 148.40056446172264 375 148.40056446172264 Z"
fill="#7cb5ec"></path><path d="M 315 139.47249061542342 C 320.328
139.47249061542342 320.328 147.47249061542342 315 147.47249061542342 C 309.672
147.47249061542342 309.672 139.47249061542342 315 139.47249061542342 Z"
fill="#7cb5ec"></path><path d="M 254 258.74018672343624 C 259.328
258.74018672343624 259.328 266.74018672343624 254 266.74018672343624 C 248.672
266.74018672343624 248.672 258.74018672343624 254 258.74018672343624 Z"
fill="#7cb5ec"></path><path d="M 193 183.6882813698486 C 198.328
183.6882813698486 198.328 191.6882813698486 193 191.6882813698486 C 187.672
191.6882813698486 187.672 183.6882813698486 193 183.6882813698486 Z"
fill="#7cb5ec"></path><path d="M 133 216.19737434460188 C 138.328
216.19737434460188 138.328 224.19737434460188 133 224.19737434460188 C 127.672
224.19737434460188 127.672 216.19737434460188 133 216.19737434460188 Z"
fill="#7cb5ec"></path><path d="M 72 71.08982807531967 C 77.328
71.08982807531967 77.328 79.08982807531967 72 79.08982807531967 C 66.672
79.08982807531967 66.672 71.08982807531967 72 71.08982807531967 Z"
fill="#7cb5ec"></path><path d="M 11 203.9803277016661 C 16.328
203.9803277016661 16.328 211.9803277016661 11 211.9803277016661 C 5.672
211.9803277016661 5.672 203.9803277016661 11 203.9803277016661 Z"
fill="#7cb5ec"></path><path d="M 440 94.46863956453404 C 445.328
94.46863956453404 445.328 102.46863956453404 440 102.46863956453404 C 434.672
102.46863956453404 434.672 94.46863956453404 440 94.46863956453404 Z"
fill="#7cb5ec"></path><path d="M 500 243.29975990431362 C 505.328
243.29975990431362 505.328 251.29975990431362 500 251.29975990431362 C 494.672
251.29975990431362 494.672 243.29975990431362 500 243.29975990431362 Z"
fill="#7cb5ec"></path><path d="M 561 217.0010483111092 C 566.328
217.0010483111092 566.328 225.0010483111092 561 225.0010483111092 C 555.672
225.0010483111092 555.672 217.0010483111092 561 217.0010483111092 Z"
fill="#7cb5ec"></path><path d="M 621 92.00460200050068 C 626.328
92.00460200050068 626.328 100.00460200050068 621 100.00460200050068 C 615.672
100.00460200050068 615.672 92.00460200050068 621 92.00460200050068 Z"
fill="#7cb5ec"></path><path d="M 682 89.17984818411858 C 687.328
89.17984818411858 687.328 97.17984818411858 682 97.17984818411858 C 676.672
97.17984818411858 676.672 89.17984818411858 682 89.17984818411858 Z"
fill="#7cb5ec"></path><path d="M 743 118.02890607581696 C 748.328
118.02890607581696 748.328 126.02890607581696 743 126.02890607581696 C 737.672
126.02890607581696 737.672 118.02890607581696 743 118.02890607581696 Z"
fill="#7cb5ec"></path><path d="M 804 120.2907735688494 C 809.328
120.2907735688494 809.328 128.2907735688494 804 128.2907735688494 C 798.672
128.2907735688494 798.672 120.2907735688494 804 120.2907735688494 Z"
fill="#7cb5ec"></path><path d="M 864 78.58885503011123 C 869.328
78.58885503011123 869.328 86.58885503011123 864 86.58885503011123 C 858.672
86.58885503011123 858.672 78.58885503011123 864 78.58885503011123 Z"
fill="#7cb5ec"></path><path d="M 925 171.15487650734747 C 930.328
171.15487650734747 930.328 179.15487650734747 925 179.15487650734747 C 919.672
179.15487650734747 919.672 171.15487650734747 925 171.15487650734747 Z"
fill="#7cb5ec"></path><path d="M 986 55.252458672587295 C 991.328
55.252458672587295 991.328 63.252458672587295 986 63.252458672587295 C 980.672
63.252458672587295 980.672 55.252458672587295 986 55.252458672587295 Z"
fill="#7cb5ec"></path><path d="M 1046 134.32840344704098 C 1051.328
134.32840344704098 1051.328 142.32840344704098 1046 142.32840344704098 C
1040.672 142.32840344704098 1040.672 134.32840344704098 1046 134.32840344704098
Z" fill="#7cb5ec"></path><path d="M 1107 181.881678517523 C 1112.328
181.881678517523 1112.328 189.881678517523 1107 189.881678517523 C 1101.672
189.881678517523 1101.672 181.881678517523 1107 181.881678517523 Z"
fill="#7cb5ec"></path><path d="M 1168 243.3321461584973 C 1173.328
243.3321461584973 1173.328 251.3321461584973 1168 251.3321461584973 C 1162.672
251.3321461584973 1162.672 243.3321461584973 1168 243.3321461584973 Z"
fill="#7cb5ec"></path></g></g><text y="25"
style="color:#333333;font-size:18px;fill:#333333;width:1200px;" zIndex="4"
class="highcharts-title" text-anchor="middle" x="632"><tspan>Live random
data</tspan></text><g zIndex="7" class="highcharts-axis-labels
highcharts-xaxis-labels"><text opacity="1" y="384"
style="color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="middle" x="158.0281867430728">17:09:18</text><text opacity="1"
y="384" style="color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="middle" x="279.50272326715356">17:09:20</text><text opacity="1"
y="384" style="color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="middle" x="400.97725979123425">17:09:22</text><text opacity="1"
y="384" style="color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="middle" x="522.451796315315">17:09:24</text><text opacity="1"
y="384" style="color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="middle" x="643.9263328393957">17:09:26</text><text opacity="1"
y="384" style="color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="middle" x="765.4008693634764">17:09:28</text><text opacity="1"
y="384" style="color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="middle" x="886.8754058875571">17:09:30</text><text opacity="1"
y="384" style="color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="middle" x="1008.3499424116378">17:09:32</text><text opacity="1"
y="384" style="color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="middle" x="1129.8244789357186">17:09:34</text><text opacity="1"
y="384" style="color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="middle" x="1243">17:09:36</text></g><g zIndex="7"
class="highcharts-axis-labels highcharts-yaxis-labels"><text opacity="1"
y="316.5"
style="width:397px;color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="end" x="59">0</text><text opacity="1" y="104.5"
style="width:397px;color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="end" x="59">1</text><text opacity="1" y="369.5"
style="width:397px;color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="end" x="59">-0.25</text><text opacity="1" y="263.5"
style="width:397px;color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="end" x="59">0.25</text><text opacity="1" y="210.5"
style="width:397px;color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="end" x="59">0.5</text><text opacity="1" y="157.5"
style="width:397px;color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="end" x="59">0.75</text><text opacity="1" y="51.5"
style="width:397px;color:#606060;cursor:default;font-size:11px;fill:#606060;"
text-anchor="end" x="59">1.25</text></g><g transform="translate(0,-9999)"
style="cursor:default;padding:0;white-space:nowrap;" zIndex="8"
class="highcharts-tooltip"><path transform="translate(1, 1)" stroke-width="5"
stroke-opacity="0.049999999999999996" stroke="black" isShadow="true" d="M 3 0 L
13 0 C 16 0 16 0 16 3 L 16 13 C 16 16 16 16 13 16 L 3 16 C 0 16 0 16 0 13 L 0 3
C 0 0 0 0 3 0" fill="none"></path><path transform="translate(1, 1)"
stroke-width="3" stroke-opacity="0.09999999999999999" stroke="black"
isShadow="true" d="M 3 0 L 13 0 C 16 0 16 0 16 3 L 16 13 C 16 16 16 16 13 16 L
3 16 C 0 16 0 16 0 13 L 0 3 C 0 0 0 0 3 0" fill="none"></path><path
transform="translate(1, 1)" stroke-width="1" stroke-opacity="0.15"
stroke="black" isShadow="true" d="M 3 0 L 13 0 C 16 0 16 0 16 3 L 16 13 C 16 16
16 16 13 16 L 3 16 C 0 16 0 16 0 13 L 0 3 C 0 0 0 0 3 0"
fill="none"></path><path d="M 3 0 L 13 0 C 16 0 16 0 16 3 L 16 13 C 16 16 16 16
13 16 L 3 16 C 0 16 0 16 0 13 L 0 3 C 0 0 0 0 3 0" fill="rgba(249, 249, 249,
.85)"></path><text y="21" style="font-size:12px;color:#333333;fill:#333333;"
zIndex="1" x="8"></text></g><text y="395"
style="cursor:pointer;color:#909090;font-size:9px;fill:#909090;" zIndex="8"
text-anchor="end" x="1254">Highcharts.com</text></svg>--></div></div>

        <script type="text/javascript">//<![CDATA[ 
        
            function validate_form1() {
                var n = parseInt(document.form1.pop_size.value);
                var f = parseFloat(document.form1.allele_freq.value);
                if (f == null || f == "" || f < 0.0 || f > 1.0) {
                    alert("Starting allele frequency must be between 0.0 and 1.0");
                    return false;
                }
                if (n == null || n == "" || n < 1 || n > 100000) {
                    alert("Population size must be an integer between 1 and 100000");
                    return false;
                }
                run_simulation();
            }
            function run_simulation() {
                var population_size = parseInt(document.form1.pop_size.value);
                var allele_freq = parseFloat(document.form1.allele_freq.value);
                drift_plot(allele_freq, population_size);
            }
            function report_fix() {
                alert("The allele was fixed!");
                location.reload(true);
            }
            function report_loss() {
                alert("The allele was lost!");
                location.reload(true);
            }
            function drift_plot(allele_freq, population_size) {
                $(document).ready(function () {
                    Highcharts.setOptions({
                        global: {
                            useUTC: false
                        }
                    });
            
                    $('#container').highcharts({
                        chart: {
                            type: 'line',
                            animation: Highcharts.svg, // don't animate in old IE
                            marginRight: 10,
                            events: {
                                load: function () {
                                    var p = allele_freq;
                                    var gen = 0;
                                    var i;
                                    var allele_count;
                                    // set up the updating of the chart each second
                                    var series = this.series[0];
                                    // var series = data[0];
                                    setInterval(function () {
                                        if (p >= 1.0) {
                                            report_fix();
                                        }
                                        if (p <= 0.0) {
                                            report_loss();
                                        }
                                        y = Math.random();
                                        allele_count = 0;
                                        for (i = 0; i < population_size; i++) {
                                            if (Math.random() < p) {
                                                allele_count += 1;
                                            }
                                        }
                                        p = allele_count / population_size;
                                        gen += 1;
                                        series.addPoint([gen, p], true, true);
                                    }, 500);
                                }
                            }
                        },
                        title: {
                            text: 'Genetic drift simulator: <i>p = ' + allele_freq + '</i>, <i>N = ' + population_size + '</i>'
                        },
                        xAxis: {
                            type: 'linear',
                            tickInterval: 2,
                            minRange: 20,
                            floor: 0,
                            title: {
                                text: 'Generation'
                            },
                            tickPixelInterval: 150
                        },
                        yAxis: {
                            min: 0,
                            max: 1,
                            title: {
                                text: 'Frequency'
                            },
                            plotLines: [{
                                value: 0,
                                width: 1,
                                color: '#808080'
                            }]
                        },
                        tooltip: {
                            formatter: function () {
                                           return '<b>' + this.series.name + '</b><br/>' + '<br/>' + Highcharts.numberFormat(this.y, 2) + '<br/>Generation: ' + Highcharts.numberFormat(this.x, 0) ;
                            }
                        },
                        legend: {
                            enabled: false
                        },
                        exporting: {
                            enabled: false
                        },
                        series: [{
                            name: 'Allele frequency',
                            data: (function () {
                                var data = [],
                                    time = (new Date()).getTime(),
                                    i;
            
                                for (i = -19; i <= 0; i += 1) {
                                    data.push({
                                        // x: time + i * 1000,
                                        x: 0,
                                        // y: Math.random()
                                        y: allele_freq
                                    });
                                }
                                return data;
                            }())
                        }]
                    });
                });
            };
            //]]>  
        </script>

    </div>
</body></html>
